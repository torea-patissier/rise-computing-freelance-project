{"ast":null,"code":"import { drawLinkLine, drawLinkTriangle } from \"./Utils\";\nimport { getDistance, getLinkColor, getRandom, getRangeValue, rangeColorToRgb } from \"tsparticles-engine\";\n\nfunction getLinkKey(ids) {\n  ids.sort((a, b) => a - b);\n  return ids.join(\"_\");\n}\n\nfunction setLinkFrequency(particles, dictionary) {\n  const key = getLinkKey(particles.map(t => t.id));\n  let res = dictionary.get(key);\n\n  if (res === undefined) {\n    res = getRandom();\n    dictionary.set(key, res);\n  }\n\n  return res;\n}\n\nexport class LinkInstance {\n  constructor(container) {\n    this.container = container;\n    this._freqs = {\n      links: new Map(),\n      triangles: new Map()\n    };\n  }\n\n  drawParticle(context, particle) {\n    var _a;\n\n    const pOptions = particle.options;\n\n    if (!particle.links || particle.links.length <= 0) {\n      return;\n    }\n\n    const p1Links = particle.links.filter(l => pOptions.links && this.getLinkFrequency(particle, l.destination) <= pOptions.links.frequency);\n\n    for (const link of p1Links) {\n      this.drawTriangles(pOptions, particle, link, p1Links);\n\n      if (link.opacity > 0 && ((_a = particle.retina.linksWidth) !== null && _a !== void 0 ? _a : 0) > 0) {\n        this.drawLinkLine(particle, link);\n      }\n    }\n  }\n\n  async init() {\n    this._freqs.links = new Map();\n    this._freqs.triangles = new Map();\n  }\n\n  particleCreated(particle) {\n    particle.links = [];\n\n    if (!particle.options.links) {\n      return;\n    }\n\n    const ratio = this.container.retina.pixelRatio;\n    particle.retina.linksDistance = particle.options.links.distance * ratio;\n    particle.retina.linksWidth = particle.options.links.width * ratio;\n  }\n\n  particleDestroyed(particle) {\n    particle.links = [];\n  }\n\n  drawLinkLine(p1, link) {\n    const container = this.container,\n          options = container.actualOptions,\n          p2 = link.destination,\n          pos1 = p1.getPosition(),\n          pos2 = p2.getPosition();\n    let opacity = link.opacity;\n    container.canvas.draw(ctx => {\n      var _a, _b, _c;\n\n      if (!p1.options.links) {\n        return;\n      }\n\n      let colorLine;\n      const twinkle = (_a = p1.options.twinkle) === null || _a === void 0 ? void 0 : _a.lines;\n\n      if (twinkle === null || twinkle === void 0 ? void 0 : twinkle.enable) {\n        const twinkleFreq = twinkle.frequency,\n              twinkleRgb = rangeColorToRgb(twinkle.color),\n              twinkling = getRandom() < twinkleFreq;\n\n        if (twinkling && twinkleRgb) {\n          colorLine = twinkleRgb;\n          opacity = getRangeValue(twinkle.opacity);\n        }\n      }\n\n      if (!colorLine) {\n        const linksOptions = p1.options.links,\n              linkColor = (linksOptions === null || linksOptions === void 0 ? void 0 : linksOptions.id) !== undefined ? container.particles.linksColors.get(linksOptions.id) : container.particles.linksColor;\n        colorLine = getLinkColor(p1, p2, linkColor);\n      }\n\n      if (!colorLine) {\n        return;\n      }\n\n      const width = (_b = p1.retina.linksWidth) !== null && _b !== void 0 ? _b : 0,\n            maxDistance = (_c = p1.retina.linksDistance) !== null && _c !== void 0 ? _c : 0;\n      drawLinkLine(ctx, width, pos1, pos2, maxDistance, container.canvas.size, p1.options.links.warp, options.backgroundMask.enable, options.backgroundMask.composite, colorLine, opacity, p1.options.links.shadow);\n    });\n  }\n\n  drawLinkTriangle(p1, link1, link2) {\n    var _a;\n\n    if (!p1.options.links) {\n      return;\n    }\n\n    const container = this.container,\n          options = container.actualOptions,\n          p2 = link1.destination,\n          p3 = link2.destination,\n          triangleOptions = p1.options.links.triangles,\n          opacityTriangle = (_a = triangleOptions.opacity) !== null && _a !== void 0 ? _a : (link1.opacity + link2.opacity) / 2;\n\n    if (opacityTriangle <= 0) {\n      return;\n    }\n\n    container.canvas.draw(ctx => {\n      var _a;\n\n      const pos1 = p1.getPosition(),\n            pos2 = p2.getPosition(),\n            pos3 = p3.getPosition(),\n            linksDistance = (_a = p1.retina.linksDistance) !== null && _a !== void 0 ? _a : 0;\n\n      if (getDistance(pos1, pos2) > linksDistance || getDistance(pos3, pos2) > linksDistance || getDistance(pos3, pos1) > linksDistance) {\n        return;\n      }\n\n      let colorTriangle = rangeColorToRgb(triangleOptions.color);\n\n      if (!colorTriangle) {\n        const linksOptions = p1.options.links,\n              linkColor = (linksOptions === null || linksOptions === void 0 ? void 0 : linksOptions.id) !== undefined ? container.particles.linksColors.get(linksOptions.id) : container.particles.linksColor;\n        colorTriangle = getLinkColor(p1, p2, linkColor);\n      }\n\n      if (!colorTriangle) {\n        return;\n      }\n\n      drawLinkTriangle(ctx, pos1, pos2, pos3, options.backgroundMask.enable, options.backgroundMask.composite, colorTriangle, opacityTriangle);\n    });\n  }\n\n  drawTriangles(options, p1, link, p1Links) {\n    var _a, _b, _c;\n\n    const p2 = link.destination;\n\n    if (!(((_a = options.links) === null || _a === void 0 ? void 0 : _a.triangles.enable) && ((_b = p2.options.links) === null || _b === void 0 ? void 0 : _b.triangles.enable))) {\n      return;\n    }\n\n    const vertices = (_c = p2.links) === null || _c === void 0 ? void 0 : _c.filter(t => {\n      const linkFreq = this.getLinkFrequency(p2, t.destination);\n      return p2.options.links && linkFreq <= p2.options.links.frequency && p1Links.findIndex(l => l.destination === t.destination) >= 0;\n    });\n\n    if (!(vertices === null || vertices === void 0 ? void 0 : vertices.length)) {\n      return;\n    }\n\n    for (const vertex of vertices) {\n      const p3 = vertex.destination,\n            triangleFreq = this.getTriangleFrequency(p1, p2, p3);\n\n      if (triangleFreq > options.links.triangles.frequency) {\n        continue;\n      }\n\n      this.drawLinkTriangle(p1, link, vertex);\n    }\n  }\n\n  getLinkFrequency(p1, p2) {\n    return setLinkFrequency([p1, p2], this._freqs.links);\n  }\n\n  getTriangleFrequency(p1, p2, p3) {\n    return setLinkFrequency([p1, p2, p3], this._freqs.triangles);\n  }\n\n}","map":{"version":3,"sources":["/Users/torea/Desktop/freelanceProject2/rise-consulting/node_modules/tsparticles-interaction-particles-links/esm/LinkInstance.js"],"names":["drawLinkLine","drawLinkTriangle","getDistance","getLinkColor","getRandom","getRangeValue","rangeColorToRgb","getLinkKey","ids","sort","a","b","join","setLinkFrequency","particles","dictionary","key","map","t","id","res","get","undefined","set","LinkInstance","constructor","container","_freqs","links","Map","triangles","drawParticle","context","particle","_a","pOptions","options","length","p1Links","filter","l","getLinkFrequency","destination","frequency","link","drawTriangles","opacity","retina","linksWidth","init","particleCreated","ratio","pixelRatio","linksDistance","distance","width","particleDestroyed","p1","actualOptions","p2","pos1","getPosition","pos2","canvas","draw","ctx","_b","_c","colorLine","twinkle","lines","enable","twinkleFreq","twinkleRgb","color","twinkling","linksOptions","linkColor","linksColors","linksColor","maxDistance","size","warp","backgroundMask","composite","shadow","link1","link2","p3","triangleOptions","opacityTriangle","pos3","colorTriangle","vertices","linkFreq","findIndex","vertex","triangleFreq","getTriangleFrequency"],"mappings":"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","sourcesContent":["import { drawLinkLine, drawLinkTriangle } from \"./Utils\";\nimport { getDistance, getLinkColor, getRandom, getRangeValue, rangeColorToRgb } from \"tsparticles-engine\";\nfunction getLinkKey(ids) {\n    ids.sort((a, b) => a - b);\n    return ids.join(\"_\");\n}\nfunction setLinkFrequency(particles, dictionary) {\n    const key = getLinkKey(particles.map((t) => t.id));\n    let res = dictionary.get(key);\n    if (res === undefined) {\n        res = getRandom();\n        dictionary.set(key, res);\n    }\n    return res;\n}\nexport class LinkInstance {\n    constructor(container) {\n        this.container = container;\n        this._freqs = {\n            links: new Map(),\n            triangles: new Map(),\n        };\n    }\n    drawParticle(context, particle) {\n        var _a;\n        const pOptions = particle.options;\n        if (!particle.links || particle.links.length <= 0) {\n            return;\n        }\n        const p1Links = particle.links.filter((l) => pOptions.links && this.getLinkFrequency(particle, l.destination) <= pOptions.links.frequency);\n        for (const link of p1Links) {\n            this.drawTriangles(pOptions, particle, link, p1Links);\n            if (link.opacity > 0 && ((_a = particle.retina.linksWidth) !== null && _a !== void 0 ? _a : 0) > 0) {\n                this.drawLinkLine(particle, link);\n            }\n        }\n    }\n    async init() {\n        this._freqs.links = new Map();\n        this._freqs.triangles = new Map();\n    }\n    particleCreated(particle) {\n        particle.links = [];\n        if (!particle.options.links) {\n            return;\n        }\n        const ratio = this.container.retina.pixelRatio;\n        particle.retina.linksDistance = particle.options.links.distance * ratio;\n        particle.retina.linksWidth = particle.options.links.width * ratio;\n    }\n    particleDestroyed(particle) {\n        particle.links = [];\n    }\n    drawLinkLine(p1, link) {\n        const container = this.container, options = container.actualOptions, p2 = link.destination, pos1 = p1.getPosition(), pos2 = p2.getPosition();\n        let opacity = link.opacity;\n        container.canvas.draw((ctx) => {\n            var _a, _b, _c;\n            if (!p1.options.links) {\n                return;\n            }\n            let colorLine;\n            const twinkle = (_a = p1.options.twinkle) === null || _a === void 0 ? void 0 : _a.lines;\n            if (twinkle === null || twinkle === void 0 ? void 0 : twinkle.enable) {\n                const twinkleFreq = twinkle.frequency, twinkleRgb = rangeColorToRgb(twinkle.color), twinkling = getRandom() < twinkleFreq;\n                if (twinkling && twinkleRgb) {\n                    colorLine = twinkleRgb;\n                    opacity = getRangeValue(twinkle.opacity);\n                }\n            }\n            if (!colorLine) {\n                const linksOptions = p1.options.links, linkColor = (linksOptions === null || linksOptions === void 0 ? void 0 : linksOptions.id) !== undefined\n                    ? container.particles.linksColors.get(linksOptions.id)\n                    : container.particles.linksColor;\n                colorLine = getLinkColor(p1, p2, linkColor);\n            }\n            if (!colorLine) {\n                return;\n            }\n            const width = (_b = p1.retina.linksWidth) !== null && _b !== void 0 ? _b : 0, maxDistance = (_c = p1.retina.linksDistance) !== null && _c !== void 0 ? _c : 0;\n            drawLinkLine(ctx, width, pos1, pos2, maxDistance, container.canvas.size, p1.options.links.warp, options.backgroundMask.enable, options.backgroundMask.composite, colorLine, opacity, p1.options.links.shadow);\n        });\n    }\n    drawLinkTriangle(p1, link1, link2) {\n        var _a;\n        if (!p1.options.links) {\n            return;\n        }\n        const container = this.container, options = container.actualOptions, p2 = link1.destination, p3 = link2.destination, triangleOptions = p1.options.links.triangles, opacityTriangle = (_a = triangleOptions.opacity) !== null && _a !== void 0 ? _a : (link1.opacity + link2.opacity) / 2;\n        if (opacityTriangle <= 0) {\n            return;\n        }\n        container.canvas.draw((ctx) => {\n            var _a;\n            const pos1 = p1.getPosition(), pos2 = p2.getPosition(), pos3 = p3.getPosition(), linksDistance = (_a = p1.retina.linksDistance) !== null && _a !== void 0 ? _a : 0;\n            if (getDistance(pos1, pos2) > linksDistance ||\n                getDistance(pos3, pos2) > linksDistance ||\n                getDistance(pos3, pos1) > linksDistance) {\n                return;\n            }\n            let colorTriangle = rangeColorToRgb(triangleOptions.color);\n            if (!colorTriangle) {\n                const linksOptions = p1.options.links, linkColor = (linksOptions === null || linksOptions === void 0 ? void 0 : linksOptions.id) !== undefined\n                    ? container.particles.linksColors.get(linksOptions.id)\n                    : container.particles.linksColor;\n                colorTriangle = getLinkColor(p1, p2, linkColor);\n            }\n            if (!colorTriangle) {\n                return;\n            }\n            drawLinkTriangle(ctx, pos1, pos2, pos3, options.backgroundMask.enable, options.backgroundMask.composite, colorTriangle, opacityTriangle);\n        });\n    }\n    drawTriangles(options, p1, link, p1Links) {\n        var _a, _b, _c;\n        const p2 = link.destination;\n        if (!(((_a = options.links) === null || _a === void 0 ? void 0 : _a.triangles.enable) && ((_b = p2.options.links) === null || _b === void 0 ? void 0 : _b.triangles.enable))) {\n            return;\n        }\n        const vertices = (_c = p2.links) === null || _c === void 0 ? void 0 : _c.filter((t) => {\n            const linkFreq = this.getLinkFrequency(p2, t.destination);\n            return (p2.options.links &&\n                linkFreq <= p2.options.links.frequency &&\n                p1Links.findIndex((l) => l.destination === t.destination) >= 0);\n        });\n        if (!(vertices === null || vertices === void 0 ? void 0 : vertices.length)) {\n            return;\n        }\n        for (const vertex of vertices) {\n            const p3 = vertex.destination, triangleFreq = this.getTriangleFrequency(p1, p2, p3);\n            if (triangleFreq > options.links.triangles.frequency) {\n                continue;\n            }\n            this.drawLinkTriangle(p1, link, vertex);\n        }\n    }\n    getLinkFrequency(p1, p2) {\n        return setLinkFrequency([p1, p2], this._freqs.links);\n    }\n    getTriangleFrequency(p1, p2, p3) {\n        return setLinkFrequency([p1, p2, p3], this._freqs.triangles);\n    }\n}\n"]},"metadata":{},"sourceType":"module"}